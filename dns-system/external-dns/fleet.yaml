defaultNamespace: dns-system

dependsOn:
  - selector:
      matchLabels:
        sealed-secrets: "true"

helm:
  repo: https://kubernetes-sigs.github.io/external-dns/
  chart: external-dns
  version: 1.20.0
  releaseName: external-dns
  values:
    sources:
      - gateway-httproute
      - gateway-grpcroute
      - gateway-tlsroute
      - gateway-tcproute
      - gateway-udproute
    provider:
      name: pihole
    extraArgs: [--pihole-api-version=6]
    env:
      - name: EXTERNAL_DNS_PIHOLE_SERVER
        value: http://pihole-web.dns-system.svc.cluster.local
      - name: EXTERNAL_DNS_PIHOLE_PASSWORD
        valueFrom:
          secretKeyRef:
            name: pihole-password
            key: EXTERNAL_DNS_PIHOLE_PASSWORD
